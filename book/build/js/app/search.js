require(["jquery","renderHeader","storage","render","text!searchTpl","lazy"],function(a,t,n,r,e,o){t({isSearch:!0});var s=n.get("history")||[];a("body").append(e);var i=a(".search-list"),c=[];function h(t){a.ajax({url:"/api/search",dataType:"json",data:{key:t},success:function(t){console.log(t),t?(i.html(" "),r(t.items,a("#search-template"),i),a("img[data-original]").lazyload({effect:"fadeIn",threshold:200,container:a(".inner-content")})):i.html("<p>暂无搜索内容</p>")},error:function(t){console.warn(t)}})}a.ajax({url:"/api/searchKey",dataType:"json",success:function(t){t.ads.forEach(function(t,e){c.push(t.ad_name)});var e=function(t){for(var e=[],a={},n=0;n<t.length;n++)a[t[n]]||(e.push(t[n]),a[t[n]]=1);return e}(s.concat(c));r(e,a("#tag-tpl"),a(".type-tags"),!0)},error:function(t){console.warn(t)}}),a(".search-btn").on("click",function(){var t=a(".ipt").val();if(a(".type-tags").hide(),i.show(),t){h(t);var e=n.get("history")||[];-1==e.indexOf(t)&&(e.push(t),n.set("history",e))}else i.html("<p>输入内容为空</p>")}),a(".ipt").on("input",function(){if(!a(this).val()){a(".type-tags").show(),i.hide(),i.html(" ");var t=n.get("history").concat(c);r(t,a("#tag-tpl"),a(".type-tags"),!0)}}),a(".type-tags").on("click","li",function(){var t=a(this).text();h(t),a(".ipt").val(t),a(".type-tags").hide(),i.show()})});